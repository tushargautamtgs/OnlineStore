<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart</title>

    <!-- styling  -->
    <style>
/* fonts */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

/* global variables */
:root {
  --bg-glass: rgba(255, 255, 255, 0.12);
  --glass-blur: blur(25px);
  --btn-gradient: linear-gradient(to right, #ff6b81, #ff4757);
  --text-light: #f7e7e7;
  --text-dark: #111; /* ‚úÖ added proper dark text variable */
  --shadow: 0px 10px 30px rgba(255, 255, 255, 0.1);
  --navbar-bg: rgba(255, 255, 255, 0.08);
  --glow-neon: rgba(255, 75, 75, 0.7);
}

body {
  font-family: 'Poppins', sans-serif;
  background: #e7c1c1;
  margin: 0;
  padding: 0;
  color: var(--text-dark);
}

/* navbar */
.navbar {
  position: fixed;
  top: 0; /* ‚úÖ was 10px, now perfectly top */
  left: 0;
  right: 0;
  background: var(--navbar-bg);
  backdrop-filter: var(--glass-blur);
  box-shadow: var(--shadow);
  padding: 15px 40px;
  z-index: 1000; /* ‚úÖ higher to stay on top */
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
}

.navbar h1 {
  font-size: 22px;
  font-weight: 600;
  margin: 5px 0;
}

.nav-links {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  margin: 5px 0;
}

.nav-links a {
  color: var(--text-dark); /* ‚úÖ fixed */
  text-decoration: none;
  font-weight: 500;
  transition: opacity 0.3s ease-in-out;
  white-space: nowrap;
  font-size: 16px;
}

.nav-links a:hover {
  opacity: 0.7;
}

/* cart section */
.cart-container {
  margin-top: 80px;
  padding: 20px 50px;
}

.cart-item {
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 10px 0;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.cart-item img {
  width: 100px;
  height: 100px;
  border-radius: 12px;
  transition: transform 0.3s ease-in-out;
}
.cart-item img:hover {
  transform: scale(1.5);
  box-shadow: 0 0 25px var(--glow-neon);
}

.cart-item-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 5px;
}

/* quantity selector */
.quantity-select {
  padding: 6px;
  border-radius: 6px;
  background: var(--bg-glass);
  border: 1px solid rgba(16, 2, 2, 0.3);
  color: var(--text-dark);
  cursor: pointer;
  transition: all 0.3s;
  font-size: 14px;
  max-width: 80px;
}

.quantity-select:hover {
  background: var(--bg-glass);
  color: #150202;
  border: none;
  box-shadow: 0 0 15px var(--glow-neon);
}

/* buttons */
.btn-group {
  display: flex;
  gap: 12px;
}

.customize-btn,
.remove-btn {
  background: var(--bg-glass);
  color: rgb(66, 20, 20);
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  transition: all 0.3s ease-in-out;
  box-shadow: 0px 0px 8px var(--glow-neon);
  white-space: nowrap;
}

.customize-btn:hover,
.remove-btn:hover {
  transform: scale(1.1);
  background: #deaeb2;
  color: #150202;
  box-shadow: 0px 0px 12px var(--glow-neon);
}

/* Subtotal Bar */
.subtotal-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 50px;
  background: var(--bg-glass);
  backdrop-filter: var(--glass-blur);
  box-shadow: var(--shadow);
  margin: 20px 50px 0;
  border-radius: 8px;
  flex-wrap: wrap;
  gap: 10px;
}

.subtotal-bar .subtotal {
  font-size: 18px;
  font-weight: bold;
}

.subtotal-bar .promo-code {
  display: flex;
  gap: 5px;
  align-items: center;
}

.subtotal-bar .promo-code input {
  padding: 6px;
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: rgba(255, 255, 255, 0.1);
  color: var(--text-light);
  font-size: 14px;
}

.subtotal-bar .promo-code button {
  background: var(--btn-gradient);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
}

.subtotal-bar .promo-code button:hover {
  transform: scale(1.05);
}

/* Place Order Button */
.place-order-container {
  padding: 20px 50px;
  display: flex;
  justify-content: center;
  margin-bottom: 30px;
}
        .logo-container {
    display: flex;
    align-items: center;
    gap: 10px;
}

.logo-img {
    height: 40px;      /* Adjust navbar size ke according */
    width: 40px;       /* Round image ke liye width = height */
    object-fit: cover; /* Image crop/fit properly */
    border-radius: 50%; /* Makes it circular */
    border: 2px solid #ccc; /* Optional: thoda border */
}





    </style>
    <head>

    </head>
    <body>
        <!-- Navbar -->

        <div class="navbar">
            <div class="logo-container">
                <img src="logo.JPG" alt="VenuResinCreation Logo" class="logo-img"/>
                <span class="logo-text">VenuResinCreation</span>
            </div>
            <div class="nav-links">
                <a href="index.html">Home</a>
                <a href="index.html">Shop</a>
                <a href="track.html">Track</a>
            </div>
        </div>
    </body>

    <!-- cart items -->

    <div class="cart-container" id="cart-items"></div>

    <div class="subtotal-bar">
        <div class="subtotal" id="subtotal">Subtotal: Rs 0.00</div>
        <div class="promo-code">
            <input type="text" id="promoInput" placeholder="Enter Promo Code"/>
            <button onclick="applyPromoCode()">Apply</button>
        </div>
    </div>

    <!-- Place order button  -->

    <div class="place-order-container">
        <button class="place-order-btn">Place Order</button>
    </div>

    <!-- Custmization req for order  -->

    <div class="modal" id="customizeModal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <h2>Customize Porduct</h2>
            <label for="customText">Enter Custmization Details</label>
            <textarea id="customText" rows="4" placeholder="e.g.. preferred colors, text to be engraved, etc."></textarea>
            <button onclick="saveCustomization()">Save</button>
            </div>
    </div>

    <!-- Order Modal  -->

<div class="modal" id="orderModal">
    <div class="modal-content order-form">
        <span class="close-modal" onclick="closeOrderModal()">&times;</span>
        <h2>Place Your Order üìù</h2>

        <label for="orderName">Full Name</label>
        <input type="text" id="orderName" placeholder="Enter your name" />

        <label for="orderEmail">Email</label>
        <input type="email" id="orderEmail" placeholder="you@example.com" />

        <label for="orderPhone">Phone Number</label>
        <input type="tel" id="orderPhone" placeholder="10-digit number" />

        <label for="orderAddress">Address</label>
        <textarea id="orderAddress" rows="2" placeholder="Full delivery address"></textarea>

        <label for="orderPincode">Pincode</label>
        <input type="text" id="orderPincode" placeholder="e.g. 400001" />

        <label for="orderLandmark">Landmark (Optional)</label>
        <input type="text" id="orderLandmark" placeholder="Nearby place if any" />

        <button onclick="submitOrder()">Submit Order</button>
    </div>
</div>

<!-- Firebase init -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>


<script>

    // firebase configs 

        const firebaseConfig = {
      apiKey: "AIzaSyA0StbmF9z2kK4WMEOpG9qO9XwlAfd",
      authDomain: "ecommerce-492b2.firebaseapp.com",
      databaseURL: "https://resinecomsite-b81db-default-rtdb.firebaseio.com/",
      projectId: "ecommerce-492b2",
      storageBucket: "ecommerce-492b2.appspot.com",
      messagingSenderId: "973139470429",
      appId: "1:973139470429:web:0c1915e57edfd72e6b0cb1"
    };

    if (!firebase.apps.length) {
      firebase.initializeApp(firebaseConfig);
    }

    const db = firebase.database();

        let cartItems = JSON.parse(localStorage.getItem('cart')) || [];
    let currentCustomizeIndex = null;

    function renderCart() {
      const cartContainer = document.getElementById("cart-items");
      cartContainer.innerHTML = "";
      cartItems.forEach((item, index) => {
        cartContainer.innerHTML += `
          <div class="cart-item">
            <img src="${item.image}" alt="${item.name}">
            <div class="cart-item-info">
              <h4>${item.name}</h4>
              <p>RS ${item.price.toFixed(2)}</p>
              <select class="quantity-select" onchange="updateQuantity(${index}, this.value)">
                ${[...Array(10)].map((_, i) =>
                  `<option value="${i + 1}" ${item.quantity === i + 1 ? 'selected' : ''}>${i + 1}</option>`
                ).join('')}
              </select>
              ${item.customization ? `<p><em>Customization:</em> ${item.customization}</p>` : ''}
            </div>
            <div class="btn-group">
              <button class="customize-btn" onclick="openModal(${index})">Customize</button>
              <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
            </div>
          </div>`;
      });
      updateSubtotal();
    }

    function updateQuantity(index, value) {
      cartItems[index].quantity = parseInt(value);
      localStorage.setItem('cart', JSON.stringify(cartItems));
      renderCart();
    }

    function removeItem(index) {
      cartItems.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cartItems));
      renderCart();
    }

    function updateSubtotal() {
      let subtotal = 0;
      cartItems.forEach(item => {
        subtotal += item.price * item.quantity;
      });
      document.getElementById("subtotal").innerText = "Subtotal: RS " + subtotal.toFixed(2);
    }

    function openModal(index) {
      currentCustomizeIndex = index;
      document.getElementById("customText").value = cartItems[index]?.customization || "";
      document.getElementById("customizeModal").style.display = "flex";
    }

    function closeModal() {
      document.getElementById("customizeModal").style.display = "none";
      currentCustomizeIndex = null;
    }

    function saveCustomization() {
      const customText = document.getElementById("customText").value;
      if (currentCustomizeIndex !== null && cartItems[currentCustomizeIndex]) {
        cartItems[currentCustomizeIndex].customization = customText;
        localStorage.setItem('cart', JSON.stringify(cartItems));
        closeModal();
        renderCart();
      }
    }

    function applyPromo() {
      const promo = document.getElementById("promoInput").value;
      if (promo) {
        alert("Promocode applied: " + promo);
      }
    }

    document.querySelector(".place-order-btn").addEventListener("click", () => {
      document.getElementById("orderModal").style.display = "flex";
    });

    function closeOrderModal() {
      document.getElementById("orderModal").style.display = "none";
    }

    function submitOrder() {
      const name = document.getElementById("orderName").value.trim();
      const phone = document.getElementById("orderPhone").value.trim();
      const address = document.getElementById("orderAddress").value.trim();
      const landmark = document.getElementById("orderLandmark").value.trim();
      const email = document.getElementById("orderEmail").value.trim();

    const orderItems = cartItems.map(item => ({
  id: item.id || "no-id",  // ‚úÖ fallback de diya
  name: item.name,
  price: item.price,
  quantity: item.quantity,
  customization: item.customization || "None"
}));


      const totalAmount = orderItems.reduce((total, item) => total + (item.price * item.quantity), 0);
      const timestamp = new Date().toISOString();
      const orderId = `ORD-${Date.now()}`;

      if (!name || !phone || !address || orderItems.length === 0) {
        alert("Please fill all required fields and add at least one item.");
        return;
      }

      const orderData = {
        customer: {
          name,
          phone,
          address,
          landmark,
          email
        },
        items: orderItems,
        orderId,
        timestamp,
        totalAmount
      };

      db.ref("orders/" + orderId).set(orderData)
        .then(() => {
<!--          alert("üéâ Order placed successfully!");-->
  showToast("üéâ Order placed successfully!");


          closeOrderModal();
          localStorage.removeItem("cart");
          cartItems = [];
          renderCart();
        })
        .catch((error) => {
          console.error("Error saving order:", error);
          alert("‚ùå Failed to place order.");
        });
    }

function showToast(message) {
  const toast = document.createElement("div");
  toast.className = "custom-toast";
  toast.innerText = message;

  document.body.appendChild(toast);

  setTimeout(() => {
    toast.remove();
  }, 3000); // Toast will auto remove after 3s
}


    renderCart();

</script>